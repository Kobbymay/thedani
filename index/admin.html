<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Admin Dashboard</title>
 <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body>
  <h1>Admin Dashboard</h1>

  <section>
    <h2>Create New Article</h2>
    <form id="articleForm">
      <input type="text" id="title" placeholder="Title" required />
      <textarea id="content" placeholder="Content" required></textarea>
      <button type="submit">Publish</button>
    </form>
  </section>

  <section>
    <h2>Existing Articles</h2>
    <div id="articles"></div>
  </section>

  <script>
    // Detect backend URL
    const API_BASE = window.location.origin.includes('localhost')
      ? 'http://localhost:3001'
      : window.location.origin;

    // Fetch and display articles
    function loadArticles() {
      fetch(`${API_BASE}/api/articles`)
        .then(res => res.json())
        .then(data => {
          const container = document.getElementById('articles');
          container.innerHTML = '';
          data.forEach(article => {
            const div = document.createElement('div');
            div.classList.add('article');
            div.innerHTML = `
              <h3>${article.title}</h3>
              <p>${article.content}</p>
              <button onclick="deleteArticle('${article.id}')">Delete</button>
            `;
            container.appendChild(div);
          });
        })
        .catch(err => console.error('Error loading articles:', err));
    }

    // Handle form submission
    document.getElementById('articleForm').addEventListener('submit', e => {
      e.preventDefault();
      const title = document.getElementById('title').value.trim();
      const content = document.getElementById('content').value.trim();

      fetch(`${API_BASE}/api/articles`, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ title, content })
      })
      .then(res => res.json())
      .then(() => {
        document.getElementById('articleForm').reset();
        loadArticles();
      })
      .catch(err => console.error('Error creating article:', err));
    });

    // Delete article
    function deleteArticle(id) {
      fetch(`${API_BASE}/api/articles/${id}`, { method: 'DELETE' })
        .then(() => loadArticles())
        .catch(err => console.error('Error deleting article:', err));
    }

    // Initial load
    loadArticles();
  </script>
</body>
</html>

